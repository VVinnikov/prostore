SELECT account_id FROM (SELECT * FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, accounts_actual.sys_op, accounts_actual.sys_to, accounts_actual.sys_from, accounts_actual.sign, accounts_actual.sys_close_date, t.transaction_id, t.transaction_date, t.account_id AS account_id0, t.amount, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON accounts_actual.account_id = t.account_id WHERE accounts_actual.sys_from <= 1 AND (accounts_actual.sys_to >= 1 AND accounts_actual.account_id = 10)) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, accounts_actual1.sys_op, accounts_actual1.sys_to, accounts_actual1.sys_from, accounts_actual1.sign, accounts_actual1.sys_close_date, t9.transaction_id, t9.transaction_date, t9.account_id AS account_id0, t9.amount, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON accounts_actual1.account_id = t9.account_id WHERE accounts_actual1.sys_from <= 1 AND (accounts_actual1.sys_to >= 1 AND accounts_actual1.account_id = 10)) AS t11 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19
---
SELECT account_id FROM (SELECT * FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, accounts_actual.sys_op, accounts_actual.sys_to, accounts_actual.sys_from, accounts_actual.sign, accounts_actual.sys_close_date, t.transaction_id, t.transaction_date, t.account_id AS account_id0, t.amount, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON accounts_actual.account_id = t.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, accounts_actual1.sys_op, accounts_actual1.sys_to, accounts_actual1.sys_from, accounts_actual1.sign, accounts_actual1.sys_close_date, t9.transaction_id, t9.transaction_date, t9.account_id AS account_id0, t9.amount, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON accounts_actual1.account_id = t9.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19
---
SELECT account_id, CASE WHEN SUM(amount) IS NOT NULL THEN SUM(amount) ELSE 0 END AS __f1, account_type, CASE WHEN account_type = 'D' AND CASE WHEN SUM(amount) IS NOT NULL THEN SUM(amount) ELSE 0 END >= 0 OR account_type = 'C' AND CASE WHEN SUM(amount) IS NOT NULL THEN SUM(amount) ELSE 0 END <= 0 THEN 'OK' ELSE 'NOT OK' END AS __f3 FROM (SELECT * FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, accounts_actual.sys_op, accounts_actual.sys_to, accounts_actual.sys_from, accounts_actual.sign, accounts_actual.sys_close_date, t.transaction_id, t.transaction_date, t.account_id AS account_id0, t.amount, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual FINAL LEFT JOIN (SELECT * FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON accounts_actual.account_id = t.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, accounts_actual1.sys_op, accounts_actual1.sys_to, accounts_actual1.sys_from, accounts_actual1.sign, accounts_actual1.sys_close_date, t9.transaction_id, t9.transaction_date, t9.account_id AS account_id0, t9.amount, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual AS accounts_actual1 LEFT JOIN (SELECT * FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON accounts_actual1.account_id = t9.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 GROUP BY account_id, account_type
---
SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11
---
SELECT account_id FROM (SELECT * FROM (SELECT t12.account_id, t13.transaction_id, t13.transaction_date, t13.account_id AS account_id0, t13.amount, t13.sys_op, t13.sys_to, t13.sys_from, t13.sign, t13.sys_close_date FROM (SELECT account_id FROM (SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11) AS t12 INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t13 ON t12.account_id = t13.account_id) AS t14 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT t32.account_id, t33.transaction_id, t33.transaction_date, t33.account_id AS account_id0, t33.amount, t33.sys_op, t33.sys_to, t33.sys_from, t33.sign, t33.sys_close_date FROM (SELECT account_id FROM (SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t31) AS t32 INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t33 ON t32.account_id = t33.account_id) AS t34 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t39
---
SELECT account_id FROM (SELECT * FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, accounts_actual.sys_op, accounts_actual.sys_to, accounts_actual.sys_from, accounts_actual.sign, accounts_actual.sys_close_date, t.transaction_id, t.transaction_date, t.account_id AS account_id0, t.amount, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON accounts_actual.account_id = t.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, accounts_actual1.sys_op, accounts_actual1.sys_to, accounts_actual1.sys_from, accounts_actual1.sign, accounts_actual1.sys_close_date, t9.transaction_id, t9.transaction_date, t9.account_id AS account_id0, t9.amount, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT * FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON accounts_actual1.account_id = t9.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 LIMIT 10
---
SELECT COUNT(*) AS EXPR__0 FROM (SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11
---
SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11
---
SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col FROM (SELECT * FROM (SELECT id, varchar_col, boolean_col, int_col, double_col, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT id, varchar_col, boolean_col, int_col, double_col, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t6 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 GROUP BY varchar_col ORDER BY varchar_col NULLS LAST LIMIT 2
---
SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col, NULL AS __f3 FROM (SELECT * FROM (SELECT id, varchar_col, boolean_col, int_col, double_col, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф')) AS t0 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT id, varchar_col, boolean_col, int_col, double_col, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф')) AS t6 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 GROUP BY varchar_col LIMIT 2
---
SELECT COUNT(category_name) AS EXPR__0, category_name, SUM(units_in_stock) AS EXPR__2, id0 FROM (SELECT * FROM (SELECT products_actual.id, products_actual.product_name, products_actual.category_id, products_actual.unit_price, products_actual.units_in_stock, products_actual.discontinued, products_actual.sys_op, products_actual.sys_to, products_actual.sys_from, products_actual.sign, products_actual.sys_close_date, t.id AS id0, t.category_name, t.description, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT * FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON products_actual.category_id = t.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT products_actual1.id, products_actual1.product_name, products_actual1.category_id, products_actual1.unit_price, products_actual1.units_in_stock, products_actual1.discontinued, products_actual1.sys_op, products_actual1.sys_to, products_actual1.sys_from, products_actual1.sign, products_actual1.sys_close_date, t9.id AS id0, t9.category_name, t9.description, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT * FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON products_actual1.category_id = t9.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 GROUP BY category_name, id0 ORDER BY id0 NULLS LAST LIMIT 5
---
SELECT COUNT(category_name) AS EXPR__0, category_name, id0, SUM(units_in_stock) AS EXPR__3 FROM (SELECT * FROM (SELECT products_actual.id, products_actual.product_name, products_actual.category_id, products_actual.unit_price, products_actual.units_in_stock, products_actual.discontinued, products_actual.sys_op, products_actual.sys_to, products_actual.sys_from, products_actual.sign, products_actual.sys_close_date, t.id AS id0, t.category_name, t.description, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT * FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON products_actual.category_id = t.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT products_actual1.id, products_actual1.product_name, products_actual1.category_id, products_actual1.unit_price, products_actual1.units_in_stock, products_actual1.discontinued, products_actual1.sys_op, products_actual1.sys_to, products_actual1.sys_from, products_actual1.sign, products_actual1.sys_close_date, t9.id AS id0, t9.category_name, t9.description, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT * FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON products_actual1.category_id = t9.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 GROUP BY category_name, id0 ORDER BY id0 NULLS LAST LIMIT 5
---
SELECT EXPR__0, EXPR__1 FROM (SELECT COUNT(category_name) AS EXPR__0, SUM(units_in_stock) AS EXPR__1, id0 FROM (SELECT * FROM (SELECT products_actual.id, products_actual.product_name, products_actual.category_id, products_actual.unit_price, products_actual.units_in_stock, products_actual.discontinued, products_actual.sys_op, products_actual.sys_to, products_actual.sys_from, products_actual.sign, products_actual.sys_close_date, t.id AS id0, t.category_name, t.description, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT * FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON products_actual.category_id = t.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT products_actual1.id, products_actual1.product_name, products_actual1.category_id, products_actual1.unit_price, products_actual1.units_in_stock, products_actual1.discontinued, products_actual1.sys_op, products_actual1.sys_to, products_actual1.sys_from, products_actual1.sign, products_actual1.sys_close_date, t9.id AS id0, t9.category_name, t9.description, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT * FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON products_actual1.category_id = t9.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 GROUP BY category_name, id0 ORDER BY id0 NULLS LAST LIMIT 5) AS t24
---
SELECT id0 FROM (SELECT * FROM (SELECT products_actual.id, products_actual.product_name, products_actual.category_id, products_actual.unit_price, products_actual.units_in_stock, products_actual.discontinued, products_actual.sys_op, products_actual.sys_to, products_actual.sys_from, products_actual.sign, products_actual.sys_close_date, t.id AS id0, t.category_name, t.description, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT * FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON products_actual.category_id = t.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT products_actual1.id, products_actual1.product_name, products_actual1.category_id, products_actual1.unit_price, products_actual1.units_in_stock, products_actual1.discontinued, products_actual1.sys_op, products_actual1.sys_to, products_actual1.sys_from, products_actual1.sign, products_actual1.sys_close_date, t9.id AS id0, t9.category_name, t9.description, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT * FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON products_actual1.category_id = t9.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 ORDER BY id0 NULLS LAST
---
SELECT COUNT(category_name) AS EXPR__0, category_name, SUM(units_in_stock) AS EXPR__2, id0 FROM (SELECT * FROM (SELECT products_actual.id, products_actual.product_name, products_actual.category_id, products_actual.unit_price, products_actual.units_in_stock, products_actual.discontinued, products_actual.sys_op, products_actual.sys_to, products_actual.sys_from, products_actual.sign, products_actual.sys_close_date, t.id AS id0, t.category_name, t.description, t.sys_op AS sys_op0, t.sys_to AS sys_to0, t.sys_from AS sys_from0, t.sign AS sign0, t.sys_close_date AS sys_close_date0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT * FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t ON products_actual.category_id = t.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT products_actual1.id, products_actual1.product_name, products_actual1.category_id, products_actual1.unit_price, products_actual1.units_in_stock, products_actual1.discontinued, products_actual1.sys_op, products_actual1.sys_to, products_actual1.sys_from, products_actual1.sign, products_actual1.sys_close_date, t9.id AS id0, t9.category_name, t9.description, t9.sys_op AS sys_op0, t9.sys_to AS sys_to0, t9.sys_from AS sys_from0, t9.sign AS sign0, t9.sys_close_date AS sys_close_date0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT * FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t9 ON products_actual1.category_id = t9.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1) AS t11 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t19 GROUP BY category_name, id0 ORDER BY id0 NULLS LAST LIMIT 5
---
SELECT id, category_name, description, id0, product_name, category_id, unit_price, units_in_stock, discontinued FROM (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date, id0, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op0, sys_to0, sys_from0, sign0, sys_close_date0 FROM (SELECT * FROM (SELECT t11.id, t11.product_name, t11.category_id, t11.unit_price, t11.units_in_stock, t11.discontinued, t11.sys_op, t11.sys_to, t11.sys_from, t11.sign, t11.sys_close_date, categories_actual.id AS id0, categories_actual.category_name, categories_actual.description, categories_actual.sys_op AS sys_op0, categories_actual.sys_to AS sys_to0, categories_actual.sys_from AS sys_from0, categories_actual.sign AS sign0, categories_actual.sys_close_date AS sys_close_date0 FROM (SELECT * FROM (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t6 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 INNER JOIN local__dml.categories_actual FINAL ON t11.id = t11.sys_close_date WHERE t11.sys_from <= 1 AND t11.sys_to >= 1) AS t13 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT t30.id, t30.product_name, t30.category_id, t30.unit_price, t30.units_in_stock, t30.discontinued, t30.sys_op, t30.sys_to, t30.sys_from, t30.sign, t30.sys_close_date, categories_actual1.id AS id0, categories_actual1.category_name, categories_actual1.description, categories_actual1.sys_op AS sys_op0, categories_actual1.sys_to AS sys_to0, categories_actual1.sys_from AS sys_from0, categories_actual1.sign AS sign0, categories_actual1.sys_close_date AS sys_close_date0 FROM (SELECT * FROM (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t19 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t25 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t30 INNER JOIN local__dml.categories_actual AS categories_actual1 ON t30.id = t30.sys_close_date WHERE t30.sys_from <= 1 AND t30.sys_to >= 1) AS t32 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t37 ORDER BY id NULLS LAST, product_name DESC NULLS FIRST) AS t39
