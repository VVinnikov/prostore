SELECT * FROM (SELECT t11.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 INNER JOIN local__shares.transactions_actual_shard FINAL ON t11.account_id = transactions_actual_shard.account_id WHERE transactions_actual_shard.sys_from <= 1 AND (transactions_actual_shard.sys_to >= 1 AND t11.account_id = 1)) AS t13 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT t33.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t28 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t33 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON t33.account_id = transactions_actual_shard1.account_id WHERE transactions_actual_shard1.sys_from <= 1 AND (transactions_actual_shard1.sys_to >= 1 AND t33.account_id = 1)) AS t35 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN local__shares.transactions_actual_shard FINAL ON accounts_actual.account_id = transactions_actual_shard.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 AND (transactions_actual_shard.sys_from <= 1 AND (transactions_actual_shard.sys_to >= 1 AND accounts_actual.account_id = 10))) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON accounts_actual1.account_id = transactions_actual_shard1.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 AND (transactions_actual_shard1.sys_from <= 1 AND (transactions_actual_shard1.sys_to >= 1 AND accounts_actual1.account_id = 10))) AS t9 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN local__shares.transactions_actual_shard FINAL ON accounts_actual.account_id = transactions_actual_shard.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 AND (transactions_actual_shard.sys_from <= 1 AND transactions_actual_shard.sys_to >= 1)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON accounts_actual1.account_id = transactions_actual_shard1.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 AND (transactions_actual_shard1.sys_from <= 1 AND transactions_actual_shard1.sys_to >= 1)) AS t9 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT accounts_actual.account_id, CASE WHEN SUM(transactions_actual_shard.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard.amount) AS BIGINT) ELSE 0 END AS __f1, accounts_actual.account_type, CASE WHEN accounts_actual.account_type = 'D' AND CASE WHEN SUM(transactions_actual_shard.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard.amount) AS BIGINT) ELSE 0 END >= 0 OR accounts_actual.account_type = 'C' AND CASE WHEN SUM(transactions_actual_shard.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard.amount) AS BIGINT) ELSE 0 END <= 0 THEN 'OK    ' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual FINAL LEFT JOIN local__shares.transactions_actual_shard FINAL ON accounts_actual.account_id = transactions_actual_shard.account_id GROUP BY accounts_actual.account_id, accounts_actual.account_type) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id, CASE WHEN SUM(transactions_actual_shard1.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard1.amount) AS BIGINT) ELSE 0 END AS __f1, accounts_actual1.account_type, CASE WHEN accounts_actual1.account_type = 'D' AND CASE WHEN SUM(transactions_actual_shard1.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard1.amount) AS BIGINT) ELSE 0 END >= 0 OR accounts_actual1.account_type = 'C' AND CASE WHEN SUM(transactions_actual_shard1.amount) IS NOT NULL THEN CAST(SUM(transactions_actual_shard1.amount) AS BIGINT) ELSE 0 END <= 0 THEN 'OK    ' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual AS accounts_actual1 LEFT JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON accounts_actual1.account_id = transactions_actual_shard1.account_id GROUP BY accounts_actual1.account_id, accounts_actual1.account_type) AS t11 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT t11.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 INNER JOIN local__shares.transactions_actual_shard FINAL ON t11.account_id = transactions_actual_shard.account_id WHERE transactions_actual_shard.sys_from <= 1 AND transactions_actual_shard.sys_to >= 1) AS t13 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT t33.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t28 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t33 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON t33.account_id = transactions_actual_shard1.account_id WHERE transactions_actual_shard1.sys_from <= 1 AND transactions_actual_shard1.sys_to >= 1) AS t35 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT * FROM (SELECT t11.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t11 INNER JOIN local__shares.transactions_actual_shard FINAL ON t11.account_id = transactions_actual_shard.account_id INNER JOIN local__shares.transactions_actual_shard FINAL AS transactions_actual_shard0 ON t11.account_id = transactions_actual_shard0.transaction_id INNER JOIN local__shares.transactions_actual_shard FINAL AS transactions_actual_shard1 ON t11.account_id = transactions_actual_shard1.transaction_id WHERE transactions_actual_shard.sys_from <= 1 AND transactions_actual_shard.sys_to >= 1 AND (transactions_actual_shard0.sys_from <= 1 AND transactions_actual_shard0.sys_to >= 1) AND (transactions_actual_shard1.sys_from <= 1 AND transactions_actual_shard1.sys_to >= 1 AND (transactions_actual_shard.account_id = 5 AND transactions_actual_shard0.transaction_id = 3))) AS t13 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT t33.account_id FROM (SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t28 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t33 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard3 ON t33.account_id = transactions_actual_shard3.account_id INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard4 ON t33.account_id = transactions_actual_shard4.transaction_id INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard5 ON t33.account_id = transactions_actual_shard5.transaction_id WHERE transactions_actual_shard3.sys_from <= 1 AND transactions_actual_shard3.sys_to >= 1 AND (transactions_actual_shard4.sys_from <= 1 AND transactions_actual_shard4.sys_to >= 1) AND (transactions_actual_shard5.sys_from <= 1 AND transactions_actual_shard5.sys_to >= 1 AND (transactions_actual_shard3.account_id = 5 AND transactions_actual_shard4.transaction_id = 3))) AS t35 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL
---
SELECT account_id FROM (SELECT * FROM (SELECT * FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual INNER JOIN local__shares.transactions_actual_shard ON accounts_actual.account_id = transactions_actual_shard.account_id) AS t WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON accounts_actual1.account_id = transactions_actual_shard1.account_id) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t15 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT * FROM (SELECT accounts_actual4.account_id FROM local__shares.accounts_actual AS accounts_actual4 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard4 ON accounts_actual4.account_id = transactions_actual_shard4.account_id) AS t23 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT * FROM (SELECT accounts_actual6.account_id FROM local__shares.accounts_actual AS accounts_actual6 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard6 ON accounts_actual6.account_id = transactions_actual_shard6.account_id) AS t31 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t39 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t LIMIT 10
