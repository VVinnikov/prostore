.kafkaUrl: &kafkaUrl ${KAFKA_BOOTSTRAP_SERVERS:10.92.3.31:9092}

logging:
  level:
    ru.ibs.dtm.query.execution: TRACE

core:
  http:
    port: ${SERVER_PORT:8088}

  env:
    name: ${DTM_NAME:test}

  datasource:
    edml:
      sourceType: ${EDML_DATASOURCE:ADB}
      defaultChunkSize: ${EDML_DEFAULT_CHUNK_SIZE:1000}
      defaultMessageLimit: ${EDML_DEFAULT_MESSAGE_LIMIT:1000}
      pluginStatusCheckPeriodMs: ${EDML_STATUS_CHECK_PERIOD_MS:1000}
      firstOffsetTimeoutMs: ${EDML_FIRST_OFFSET_TIMEOUT_MS:15000}
      changeOffsetTimeoutMs: ${EDML_CHANGE_OFFSET_TIMEOUT_MS:10000}
    zookeeper:
      connection-string: ${ZOOKEEPER_DS_ADDRESS:10.92.3.31}
      connection-timeout-ms: ${ZOOKEEPER_DS_CONNECTION_TIMEOUT_MS:30000}
      session-timeout-ms: ${ZOOKEEPER_DS_SESSION_TIMEOUT_MS:86400000}
      chroot: ${ZOOKEEPER_DS_CHROOT:/adtm}
  vertx:
    pool:
      task-pool: 10
      task-timeout: 86400000

  kafka:
    producer:
      property:
        bootstrap.servers: *kafkaUrl
        key.serializer: org.apache.kafka.common.serialization.StringSerializer
        value.serializer: org.apache.kafka.common.serialization.StringSerializer
    consumer:
      core:
        bootstrap.servers: *kafkaUrl
        group.id: core-query-execution
        key.deserializer: org.apache.kafka.common.serialization.ByteArrayDeserializer
        value.deserializer: org.apache.kafka.common.serialization.ByteArrayDeserializer
        number: 8
    cluster:
      zookeeperHosts: ${ZOOKEEPER_HOSTS:10.92.3.31}
      zookeeperPort: ${ZOOKEEPER_PORT:2181}
      rootPath: ${KAFKA_CLUSTER_ROOTPATH:arenadata/cluster/21}
    admin:
      inputStreamTimeoutMs: ${KAFKA_INPUT_STREAM_TIMEOUT_MS:2000}
    status.event.publish:
      enabled: false
      topic: status.event
    statusMonitorUrl: ${STATUS_MONITOR_URL:http://127.0.0.1:9095/status}

adb:
  datasource:
    options:
      database: ${ADB_DB_NAME:adb}
      user: ${ADB_USERNAME:gpadmin}
      password: ${ADB_PASS:gpadmin}
      host: ${ADB_HOST:10.92.3.14}
      port: ${ADB_PORT:5432}
      maxSize: 20

  connector:
    host: ${ADB_MPPR_CONNECTOR_HOST:10.92.3.14}
    port: ${ADB_MPPR_CONNECTOR_PORT:8086}
    url: ${ADB_MPPR_CONNECTOR_URL:/query}

  mppw:
    startLoadUrl: ${ADB_START_LOAD_URL:http://10.92.3.3:8090/newdata/adb/start}
    consumerGroup: ${ADB_LOAD_GROUP:adb-emulator-load-adb}
    poolSize: ${ADB_MPPW_POOL_SIZE:2}
    stopTimeoutMs: ${ADB_MPPW_STOP_TIMEOUT_MS:86400000}

adg:
  tarantool:
    db:
      host: ${TARANTOOL_DB_HOST:10.92.3.33}
      port: ${TARANTOOL_DB_PORT:3301}
      user: ${TARANTOOL_DB_USER:admin}
      password: ${TARANTOOL_DB_PASS:memstorage-cluster-cookie}
      operationTimeout: ${TARANTOOL_DB_OPER_TIMEOUT:60000}
      retryCount: ${TARANTOOL_DB_RETRY_COUNT:0}
    cartridge:
      url: ${TARANTOOL_CATRIDGE_URL:http://10.92.3.33:8081}
  mppw:
    consumerGroup: ${ADG_CONSUMER_GROUP:tarantool-group-csv}
    kafka:
      maxNumberOfMessagesPerPartition: 200
      callbackFunctionSecIdle: 100
  rollback:
    eraseOperationBatchSize: 300
  circuitbreaker:
    maxFailures: 5
    timeout: 30000
    fallbackOnFailure: false
    resetTimeout: 10000

adqm:
  datasource:
    database: ${ADQM_DB_NAME:upload}
    user: ${ADQM_USERNAME:}
    password: ${ADQM_PASS:}
    hosts: ${ADQM_HOSTS:10.92.3.24:8123}

  ddl:
    cluster: ${ADQM_CLUSTER:test_arenadata}
    ttlSec: ${ADQM_TTL_SEC:3600}
    archiveDisk: ${ADQM_ARCHIVE_DISK:default}

  mppw:
    consumerGroup: ${ADQM_CONSUMER_GROUP:adqm}
    kafkaBrokers: ${ADQM_BROKERS:10.92.3.31:9092}
    loadType: ${ADQM_MPPW_LOAD_TYPE:REST}
    restLoadUrl: ${ADQM_REST_LOAD_URL:http://10.92.3.3:8090/newdata/adqm}
    restLoadConsumerGroup: ${ADQM_REST_LOAD_GROUP:adb-emulator-load-adqm}
